/*!
(C) Andrea Giammarchi, @WebReflection - Mit Style License
*/
var wru=function(U){function g(){w=G.call(i);if(w){k(Z);k((ad(w,O)&&w[O])||(ad(w,e)&&w[e])||M);a=[];p=[];P=[];X={};b("setup");P[ae]||b("test");b("teardown");J||m()}else{o()}}function k(ag){try{require("sys").print(ag+"\n")}catch(af){print(ag)}}function o(){k(f);k(Z);switch(true){case !!aa:k(N+"   "+aa+" Errors");case !!z:k(K+f+z+" Failures");default:k(y+"      "+n+" Passes")}k(Z);k(f);try{process.exit()}catch(af){quit()}}function c(af){for(var ag=0,ah=af.length;ag<ah;k("    "+(++ag)+". "+af[ag])){}}function m(){n+=a[ae];z+=p[ae];aa+=P[ae];if(P[ae]){S=N;c(P)}else{if(p[ae]){S=K;c(p)}else{S=y}}k(S+" passes: "+a[ae]+", fails: "+p[ae]+", errors: "+P[ae]);I=0;S=f;g()}function b(af){if(ad(w,af)){try{w[af](X)}catch(ag){W.call(P,f+ag)}}}function ad(ag,af){return l.call(ag,af)}function r(){return C()<0.5?-1:1}var V={assert:function Q(ag,af){if(arguments[ae]==1){af=ag;ag=M}u=E;W.call(af?a:p,S+ag)},async:function R(ag,aj,ah,ai){ai=++J;if(typeof ag=="function"){ah=aj;aj=ag;ag="asynchronous test #"+ai}ah=T(function(){ai=0;W.call(p,ag);--J||m()},H(ah||t)||t);return function af(){if(!ai){return}u=ab;S=ag+": ";try{aj.apply(this,arguments)}catch(ak){u=E;W.call(P,S+doooodeThisIsBAD)}S=f;if(u){D(ah);--J||m()}}},test:function j(af){i=F.apply(i,[af]);V.random&&ac.call(i,r);J||g()}},E=true,ab=!E,t=100,f=" ",v=", ",M="unknown",ae="length",B="innerHTML",O="name",e="description",A="<li>",d="</li>",l=V.hasOwnProperty,S=f,Y=S.charAt,s=S.slice,i=[],F=i.concat,q=i.join,W=i.push,G=i.shift,ac=i.sort,J=0,I=0,n=0,z=0,aa=0,h="\\|/-",N="[ERROR]",K="[FAILURE]",y="[OK]",Z="------------------------------",x,H,C,T,D,w,L,a,p,P,X,u;if(typeof global!="function"){U.wru=V;U=global}x=U.Math;H=x.abs;C=x.random;T=U.setTimeout;D=U.clearTimeout;U.setInterval(function(){J&&k(f+Y.call(h,I++%4)+"\033[<1>A")},t);t*=t;V.random=ab;return V}(this);